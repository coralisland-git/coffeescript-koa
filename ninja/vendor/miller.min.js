function Category(){var t=this;t.categoryId=guid(),t.setCategoryId=function(e){t.categoryId=e},t.getCategoryId=function(){return t.categoryId},t.setCategoryName=function(e){t.categoryName=e},t.getCategoryName=function(){return t.categoryName},t.setParentId=function(e){t.parentId=e},t.getParentId=function(){return t.parentId},t.setIsLowestLevel=function(e){t.isLowestLevel=e},t.getIsLowestLevel=function(){return t.isLowestLevel},t.setItems=function(e){t.items=e},t.getItems=function(){return t.items}}function CategoryItem(){var t=this;t.itemId=guid(),t.setItemId=function(e){t.itemId=e},t.getItemId=function(){return t.itemId},t.setItemName=function(e){t.itemName=e},t.getItemName=function(){return t.itemName},t.setItemIcon=function(e){t.itemIcon=e},t.getItemIcon=function(){return t.itemIcon},t.setParentId=function(e){t.parentId=e},t.getParentId=function(){return t.parentId},t.setCategoryId=function(e){t.categoryId=e},t.getCategoryId=function(){return t.categoryId},t.setHasChildren=function(e){t.hasChildren=e},t.getHasChildren=function(){return t.hasChildren},t.isDeletable=!0,t.setIsDeletable=function(e){t.isDeletable=e},t.getIsDeletable=function(){return t.isDeletable}}function guid(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}!function(t){t.fn.millerColumn=function(e){function i(e,i){var l=t("<div/>").addClass("miller-col-list-item");if(l.attr("data-has-children",e.hasChildren),l.attr("data-item-id",e.itemId),l.attr("data-parent-id",e.parentId),l.attr("data-category-id",e.categoryId),l.attr("data-is-deletable",e.isDeletable),l.attr("data-item-name",e.itemName),l.attr("data-item-icon",e.itemIcon),""!=e.itemIcon&&null!=e.itemIcon&&l.append(t("<i/>").addClass("material-icons list-item-icon").text(e.itemIcon)),l.append(t("<span/>").text(e.itemName).addClass("list-item-text")),e.hasChildren&&l.append(t("<i/>").addClass("material-icons").addClass("has-children")),0==i){var a=t("<span/>").addClass("list-item-actions").append(t("<i/>").addClass("material-icons").addClass("edit").text("edit"));a.append(t("<i/>").addClass("material-icons").addClass("delete").text("delete")),l.append(a)}return l}function l(){var e=0;return E&&console.log("About to calculate total width ..."),c.call(this).each(function(){x.call(this)||(e+=t(this).outerWidth(),E&&console.log("added width: "+t(this).outerWidth()))}),e+=x.call(d.call(this))?0:d.call(this).outerWidth(),E&&console.log("totalColsWidth: "+e+" body width:"+t(this).outerWidth()),e}function a(){n.call(this),u.call(this),Y.call(this),r.call(this)}function n(){z.call(this),S.call(this)}function r(){if(0==g.call(this).length){var e=t("<span/>").addClass("miller-col-nav nav-prev hidden").append(t("<i/>").addClass("material-icons")),i=t("<div/>").addClass("miller-cols-body"),l=t("<div/>").addClass("miller-col-loading-container col-loading hidden").append(t("<div/>").addClass("miller-col-body").append(t("<div/>").addClass("miller-col-list-item loading-icon-container spinner")));i.append(l);var a=t("<span/>").addClass("miller-col-nav nav-next hidden").append(t("<i/>").addClass("material-icons"));t(this).append(e).append(i).append(a)}t(this).addClass("miller-cols-container-wrapper"),t(this).css({height:_.height}),t(this).attr("millerized",""),t(this).attr("data-is-read-only",_.isReadOnly)}function s(){return t(this).is("[millerized]")}function c(){return t(this).find(".miller-col-container")}function o(){return".col-loading"}function d(){return t(this).find(o())}function h(){return D.call(d.call(this))}function u(){return k.call(d.call(this))}function f(){return t(this).find(".miller-col-nav.nav-prev")}function m(){return t(this).find(".miller-col-nav.nav-next")}function g(){return t(this).find(".miller-cols-body")}function p(){return".miller-col-body .miller-col-list-item"}function v(){return".miller-col-body"}function I(){return".miller-col-container"}function y(){return".miller-col-container:not(.col-loading)"}function C(){var t=g.call(this).find(".miller-col-container:not(.hidden):first");return 0!=t.length?t:x.call(d.call(this))?null:d.call(this)}function w(){return x.call(C.call(this).prev())}function b(){return x.call(N.call(this).next().not(o()))}function N(){return x.call(d.call(this))?g.call(this).find(".miller-col-container:not(.hidden):last"):d.call(this)}function x(){return t(this).hasClass(Z)}function k(){x.call(this)||t(this).addClass(Z)}function D(){x.call(this)&&t(this).removeClass(Z)}function W(){D.call(f.call(this))}function L(){return x.call(m.call(this))}function O(){return x.call(f.call(this))}function P(){D.call(m.call(this))}function z(){k.call(f.call(this))}function S(){k.call(m.call(this))}function J(){return t(g.call(this)).children(":not(.hidden)").length>1?g.call(this).outerWidth()+1<l.call(g.call(this)):!1}function A(t){var e=g.call(this);return J.call(this)||e.outerWidth()+1<l.call(e)+t.outerWidth()}function M(){t(this).is(te)||t(this).addClass($)}function R(){t(this).removeClass($)}function T(){t(this).nextAll(":not(.col-loading)").remove()}function j(){var e=new CategoryItem;return e.setCategoryId(t(this).attr("data-category-id")),e.setItemId(t(this).attr("data-item-id")),e.setItemName(t(this).attr("data-item-name")),e.setItemIcon(t(this).attr("data-item-icon")),e.setHasChildren(t(this).attr("data-has-children")),e.setIsDeletable(t(this).attr("data-is-deletable")),e.setParentId(t(this).attr("data-parent-id")),e}function H(){var e=new Category;return e.setCategoryId(t(this).attr("data-category-id")),e.setCategoryName(t(this).attr("data-category-name")),e.setIsLowestLevel(t(this).attr("data-is-lowest-level")),e.setParentId(t(this).attr("data-parent-id")),e}function U(){for(;!J.call(this)&&w.call(this);)D.call(C.call(this).prev());J.call(this)&&k.call(C.call(this)),w.call(this)||z.call(this),w.call(this)||L.call(this)||A.call(this,N.call(this).next())||Y.call(this,X,G)}function q(){for(;J.call(this);)k.call(C.call(this)),W.call(this)}function B(){for(;!J.call(this)&&b.call(this);)if(D.call(N.call(this).next()),!b.call(this)){S.call(this);break}b.call(this)||O.call(this)||A.call(this,C.call(this).prev())||Y.call(this,V,G)}function Q(){for(;J.call(this);)k.call(N.call(this)),P.call(this)}function Y(t,e){switch(e=e||K,t=t||V){case X:switch(e){case K:Q.call(this);break;case G:B.call(this);break;default:console.error("Unkown scaleType: "+e)}break;case V:switch(e){case K:q.call(this);break;case G:U.call(this);break;default:console.error("Unknown scaleType:"+e)}break;default:console.error("Unknown hideDirection: "+t)}}var _={isReadOnly:!0,height:"400px"},E=!1,F=Array.prototype.slice.call(arguments);"string"!=typeof F[0]&&(_=t.extend(_,e));var G="scaleup",K="scaledown",V="left",X="right",Z="hidden",$="selected",te=".selected",ee="has-children",ie=t(window).outerWidth();if("addCol"==F[0]){if(!s.call(this))return void(E&&console.log("element is is not initialized as a miller column. You need to call jQuery('#id).millerColumn() first."));if(F[1].jquery)F[1].insertBefore(d.call(this));else if(F[1].categoryId){try{if(!F[1].categoryId)return void u.call(this);for(var le=N.call(this),ae=le.is(".col-loading")?le.prev():le,ne=ae.find(p()).filter(".selected"),re=0;F[1].items&&re<F[1].items.length;++re){var se=F[1].items[re];if(0!=ne.length&&ne.data("item-id")!=se.parentId)return console.warn("Response expired; current selected item is not same as the parent of provided list item."),void u.call(this)}}catch(ce){console.error(ce),u.call(this)}var oe=JSON.parse(t(this).attr("data-is-read-only"));if(oe&&0==F[1].items.length)return;var de=t("<div/>");de.addClass("miller-col-container"),de.attr("data-category-id",F[1].categoryId),de.attr("data-category-name",F[1].categoryName),de.attr("data-is-lowest-level",F[1].isLowestLevel),de.attr("data-parent-id",F[1].parentId);var he=t("<div/>"),ue=t("<div>").addClass("miller-col-title-text").append(t("<span/>").text(F[1].categoryName));if(!oe){var fe=t("<span/>").addClass("miller-col-actions").append(t("<i/>").addClass("material-icons").addClass("action-add").text("add"));ue.append(fe)}he.addClass("miller-col-title"),he.append(ue),de.append(he);for(var me=t("<div/>").addClass("miller-col-body"),ge=0;ge<F[1].items.length;++ge){var pe=i(F[1].items[ge],oe);me.append(pe)}de.append(me),de.insertBefore(d.call(this))}return this}if("addItem"==F[0]){var ve=F[1],Ie=t(this).find(p()).filter("[data-item-id = '"+ve.parentId+"']");if(null!=Ie){var ye=Ie.data("has-children");Ie.data("has-children",!0),Ie.attr("data-has-children",!0),ye||Ie.append(t("<i/>").addClass("material-icons").addClass("has-children"))}var Ce=c.call(this).filter("[data-category-id='"+ve.categoryId+"']");if(null==Ce)return void(E&&console.log("Cant find category with id: "+ve.categoryId));var we=Ce.find(v());return console.log(we),we.append(i(ve,!1)),this}if("updateItem"==F[0]){var be=F[1],Ne=t(this).find(p()).filter("[data-item-id = '"+be.itemId+"']");return null!=Ne&&(Ne.find(".list-item-text").text(be.itemName),Ne.attr("data-item-name",be.itemName),Ne.find(".list-item-icon").text(be.itemIcon)),this}if("deleteItem"==F[0]){var xe=F[1],ke=t(this).find(p()).filter("[data-item-id = '"+xe.itemId+"']"),De=t(this).find(p()).filter("[data-item-id = '"+xe.parentId+"']");if(null!=De){var We=t(this).find(p()).filter("[data-parent-id = '"+xe.parentId+"']");(null==We||0==We.length)&&(De.data("has-children",!1),De.attr("data-has-children",!1),De.find("i").filter(".has-children").remove())}return t(ke).closest(I()).next(y()).remove(),null!=ke&&ke.remove(),this}var Le=function(){var t={};return function(e,i,l){l||(l="Don't call this twice without a uniqueId"),t[l]&&clearTimeout(t[l]),t[l]=setTimeout(e,i)}}();return this.each(function(){var e=this;a.call(e),F[0]&&F[0].initData&&(t(e).find(y()).remove(),t(e).millerColumn("addCol",F[0].initData)),f.call(e).on("click",function(){D.call(C.call(e).prev()),w.call(e)||z.call(e),Y.call(e,X)}),m.call(e).on("click",function(){D.call(N.call(e).next()),b.call(e)||S.call(e),Y.call(e,V)}),g.call(e).on("DOMNodeInserted",function(i){t(i.target).is(I())&&(E&&console.log("Dom inserted.."),u.call(e),Y.call(e,V))}),g.call(e).on("DOMNodeRemoved",function(i){t(i.target).is(I())&&(E&&console.log("Dom removed.."),Y.call(e,V,G))}),g.call(e).on("click",p(),function(){var i=t(this).closest(I());T.call(i),L.call(e)||S.call(e),1==t(this).data(ee)&&h.call(e),Y.call(e,V,K),R.call(i.find(p())),M.call(this);var l=j.call(this);t(this).trigger("item-selected",l),E&&console.log("fired item-selected event: "+JSON.stringify(l))}),g.call(e).on("click",".list-item-actions .edit",function(e){var i=t(this).closest(p()),l=j.call(i);t(i).trigger("edit-item",l),E&&console.log("fired edit item event: "+JSON.stringify(l)),e.stopPropagation()}),g.call(e).on("click",".list-item-actions .delete",function(e){var i=t(this).closest(p()),l=j.call(i);t(i).trigger("delete-item",l),E&&console.log("fired delete item event: "+JSON.stringify(l)),e.stopPropagation()}),g.call(e).on("click",".miller-col-actions .action-add",function(){var e=t(this).closest(I()),i=e.prev(),l=H.call(e);i&&(l.parentId=t(i).find(p()).filter(te).data("item-id")),t(e).trigger("add-item",l),E&&console.log("fired add item event: "+JSON.stringify(l))}),t(window).on("resize.miller_column",function(){Le(function(){E&&console.log("window resized.."),t(window).outerWidth()!=ie&&(E&&console.log("About to resize: old width:"+ie+" new one: "+t(window).outerWidth()),n.call(e),t(window).outerWidth()<ie?Y.call(e,V,K):Y.call(e,V,G),b.call(e)&&P.call(e),w.call(e)&&W.call(e),ie=t(window).outerWidth())},500,t(e).attr("id"))})})}}(jQuery);